version: "3"
networks:
  default:
    name: traefik
  loki:
    name: loki

# https://grafana.com/docs/grafana/next/setup-grafana/installation/docker/
# https://github.com/prometheus/prometheus

services:    
  grafana:
    container_name: grafana
    image: grafana/grafana
    restart: unless-stopped
    user: ${PUID:-1000}
    networks:
      - default
      - loki
    env_file:
      - .env
    volumes:
      - ./etc/grafana:/var/lib/grafana
      - ./etc/grafana/provisioning:/etc/grafana/provisioning
    labels:
      - joyride.host.name=grafana.${HOST_DOMAIN}
      - com.centurylinklabs.watchtower.enable=true
      - traefik.enable=true
      - traefik.http.routers.grafana.rule=Host(`grafana.${HOST_DOMAIN}`)
      - traefik.http.routers.grafana.entrypoints=websecure
      - traefik.http.services.grafana.loadbalancer.server.scheme=http
      - traefik.http.services.grafana.loadbalancer.server.port=3000

